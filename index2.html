<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta property="og:image" content="https://github.com/rtoip-ikswejam/FCD/blob/f18b5bd07fdc1d8b997cda19486f31546dbed712/SA%20Clock%20Button.png" />
  <meta property="og:title" content="Dla niecierpliwych" />
  <meta property="og:description" content="Licznik czasu do koncertu" />
  <title>Dla niecierpliwych</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #111;
      color: #fff;
      text-align: center;
      margin: 0;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 2rem;
    }

    .countdown {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 1rem;
      width: 100%;
      max-width: 600px;
    }

    .tile {
      background-color: #00ffcc;
      color: #000;
      border-radius: 1rem;
      padding: 2rem 1rem;
      font-size: 1.5rem;
      font-weight: bold;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 8px rgba(0, 255, 204, 0.5);
    }

    .label {
      font-size: 0.875rem;
      margin-top: 0.5rem;
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        animation: none !important;
        transition: none !important;
      }
    }
  </style>
</head>
<body>
  <h1 id="event-title" role="heading" aria-live="polite">Ładowanie...</h1>
  <div class="countdown" aria-live="polite">
    <div class="tile" id="days">--<div class="label">dni</div></div>
    <div class="tile" id="hours">--<div class="label">godzin</div></div>
    <div class="tile" id="minutes">--<div class="label">minut</div></div>
    <div class="tile" id="seconds">--<div class="label">sekund</div></div>
  </div>

  <script>
    const SPREADSHEET_ID = '1erA77VcSTYUT-RB5boJD1s5W0UtQNX8VGUdEtQQ5SaI';
    const SHEET_GID = '0'; // zakładamy, że używasz pierwszego arkusza (GID=0)

    async function fetchEventData() {
      const url = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/export?format=tsv&gid=${SHEET_GID}`;
      try {
        const response = await fetch(url);
        const tsvText = await response.text();
        const rows = tsvText.trim().split('\n');

        if (rows.length < 2) throw new Error("Brak drugiego wiersza w arkuszu");

        const cells = rows[1].split('\t');
        const [yearRaw, monthRaw, dayRaw, hourRaw, minuteRaw, descRaw] = cells;

        const year = parseInt(yearRaw);
        const month = parseInt(monthRaw);
        const day = parseInt(dayRaw);
        const hour = parseInt(hourRaw);
        const minute = parseInt(minuteRaw);
        const description = descRaw.replace(/^"|"$/g, '').trim();

        if (
          isNaN(year) || isNaN(month) || isNaN(day) ||
          isNaN(hour) || isNaN(minute) || !description
        ) {
          throw new Error("Nieprawidłowe dane w arkuszu.");
        }

        const eventDate = new Date(year, month - 1, day, hour, minute);
        document.getElementById("event-title").textContent = description;
        startCountdown(eventDate);
      } catch (error) {
        console.error('Błąd przy pobieraniu danych:', error);
        document.getElementById("event-title").textContent = "Nie udało się pobrać danych wydarzenia.";
      }
    }

    function startCountdown(eventDate) {
      function update() {
        const now = new Date();
        const diff = eventDate - now;

        if (diff <= 0) {
          document.querySelector(".countdown").innerHTML = '<div class="tile">Wydarzenie trwa!</div>';
          clearInterval(interval);
          return;
        }

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
        const minutes = Math.floor((diff / (1000 * 60)) % 60);
        const seconds = Math.floor((diff / 1000) % 60);

        document.getElementById("days").childNodes[0].textContent = days;
        document.getElementById("hours").childNodes[0].textContent = hours;
        document.getElementById("minutes").childNodes[0].textContent = minutes;
        document.getElementById("seconds").childNodes[0].textContent = seconds;
      }

      update();
      const interval = setInterval(update, 1000);
    }

    fetchEventData();
  </script>
</body>
</html>
